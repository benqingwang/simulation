<h1>利用simulation做计算</h1>

<h2>目录</h2>
<ol>
  <li>利用derivative估计函数值</li>
  <li>利用simulation计算复杂的积分问题</li>
  <li>利用simulation计算 $\pi$ 值</li>
</ol>

<h2>Section 1: 利用derivative估计函数值</h2>
我们有一个函数 

$$
f(x) = 10e^{2x}
$$
如果我们想求f(0.01), f(0.02), ... f(0.10)，可以直接带入
<ul>
  <li>$f(0.01) = 10e^{0.02} = 10.20$</li>
  <li>$f(0.02) = 10e^{0.04} = 10.41$</li>
  <li>$f(0.03) = 10e^{0.06} = 10.62$</li>
  <li>$f(0.04) = 10e^{0.08} = 10.83$</li>
  <li>$f(0.10) = 10e^{0.20} = 12.21$</li>
</ul>

但是现在假装不知道f(x)，只提供下面2个信息。
<ul>
  <li>$f'(x) = 2f(x)$</li>
  <li>$f(0)=10$</li>
</ul>
我们现在要估计f(0.01), f(0.02), ... f(0.10)要怎么办？ 

解答的方法是： 因为 $f(x+h) \approx f(x) + h f'(x)$ 所以有：
<ul>
  <li>$f(x+h) = f(x) + f'(x)h = f(x) + 2f(x)h = f(x)*(1+2h)$</li>
  <li>$f(x+2h) = f(x+h) + f'(x+h)h = f(x+h) + 2f(x+h)h = f(x+h)(1+2h)= f(x)(1+2h)(1+2h) =f(x)*(1+2h)^2$</li>
  <li>可以推理得 $f(x+i*h) = f(x)(1+2h)^i, i = 0, 1, 2, ...$ </li>
</ul>

现在带入 $f(0)=10$, 我们设定h是一个很小的数，比如0.01。这样 $f(0+i * 0.01) = f(0)(1 + 2*0.01)^i, i = 0, 1, 2, ...$ 
<ul>
  <li>$f(0.01) = f(0)(1 + 2 * 0.01)^1 =  10.20$</li>
  <li>$f(0.02) = f(0)(1 + 2 * 0.01)^2 =  10.40$</li>
  <li>$f(0.03) = f(0)(1 + 2 * 0.01)^3 =  10.61$</li>
  <li>$f(0.04) = f(0)(1 + 2 * 0.01)^4 =  10.82$</li>
  <li>$f(0.10) = f(0)(1 + 2 * 0.01)^{10} =  10.19$</li>
</ul>
所以可见我们的approximation在i很小的情况下，效果不错的。

<h2>Section 2: 利用simulation求积分</h2>
为什么要这么做呢？因为有的积分很难手动解出来。用simulation的方法求面积得到积分结果是很棒的。比如你手动试验一下这个: 

$$
\int_{0}^{1} ln(x)ln(1-x) \ dx
$$

老师这里用了一个简单例子来说明过程。

$$
比如我们要求 \sin(\pi x)在（0，1）上的积分。
$$ 

$$
I = \int_{0}^{1} \sin(\pi x) \ dx
$$ 

如果我直接用积分计算是这样的

$$
I = \int_{0}^{1} \sin(\pi x) \ dx = -\frac{1}{\pi} (cos(\pi)x)\vert_{1}^{0} = -\frac{1}{\pi} (-1-(1))=\frac{2}{\pi} \approx 0.6366
$$ 

如果我用上面的方法就是可以抽n个随机的(0,1)之间的数，带入$sin(\pi x)$，然后计算平均值。
![image](https://github.com/benqingwang/simulation/assets/158376214/b9f89b85-2076-40ef-bf04-212542ef905e)
可见当我们的sample比较多之后，这个值稳定在6.3左右，和我用积分得到的结果一样。

我下面用老师给的4个数来展示具体的计算estimate和confidence interval的过程
![image](https://github.com/benqingwang/simulation/assets/158376214/70de848e-0455-4ffb-a647-821550414801)


